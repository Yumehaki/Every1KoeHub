{% extends "base.html" %}
{% block content %}
<div class="model-header">
  <div class="thumb-lg">
    {% if model.icon_path %}
      <img src="/media/models/{{ model.uuid }}/icon" alt="icon">
    {% else %}
      <img src="/static/defaults/model.svg" alt="icon">
    {% endif %}
  </div>
  <div>
    <h1>
      {{ model.name }}
      {% if model.is_certified %}<img src="/static/defaults/verified.svg" alt="cert" style="width:20px;vertical-align:middle;margin-left:6px">{% endif %}
      {% if model.is_locked %}<img src="/static/defaults/lock.svg" alt="lock" style="width:18px;vertical-align:middle;margin-left:6px">{% endif %}
    </h1>
    <p class="muted">UUID: {{ model.uuid }} ï¼ æŠ•ç¨¿è€…: <a href="/users/{{ model.author.uuid }}">{{ model.author.username if model.author else "unknown" }}</a></p>
    <p>{{ model.description }}</p>
    <p class="meta">â™¥ {{ model.likes_count }} ï¼ â†“ {{ model.downloads }}</p>
  </div>
</div>

<pre class="box">ãƒ©ã‚¤ã‚»ãƒ³ã‚¹å: {{ model.license_name }}
æœ¬æ–‡:
{{ model.license_text }}</pre>

<p>ã‚µã‚¤ã‚º: {{ model.size_bytes }} bytes / SHA-256: {{ model.sha256 }}</p>

<p class="btn-row">
  {% if not model.is_locked %}
    <a class="btn" href="/download/{{ model.uuid }}">ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</a>
  {% else %}
    <button class="btn" disabled title="æ–½éŒ ä¸­ã®ãŸã‚ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ä¸å¯">ğŸ”’ æ–½éŒ ä¸­</button>
  {% endif %}
  <form method="post" action="/models/{{ model.uuid }}/like" style="display:inline">
    <button class="btn ghost" type="submit">â™¥ ã„ã„ã­ ({{ model.likes_count }})</button>
  </form>
  {% if user and user.uuid == model.user_uuid %}
    <a class="btn ghost" href="/models/{{ model.uuid }}/edit">ç·¨é›†</a>
    <form method="post" action="/models/{{ model.uuid }}/reextract" style="display:inline">
      <button class="btn ghost" type="submit">å†æŠ½å‡º</button>
    </form>
    <form method="post" action="/models/{{ model.uuid }}/delete" style="display:inline" onsubmit="return confirm('å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ');">
      <button class="btn ghost" type="submit">å‰Šé™¤</button>
    </form>
  {% endif %}
  {% if user and user.is_admin %}
    {% if not model.is_locked %}
      <form method="post" action="/admin/models/{{ model.uuid }}/lock" style="display:inline">
        <button class="btn ghost" type="submit">ğŸ”’ æ–½éŒ </button>
      </form>
    {% else %}
      <form method="post" action="/admin/models/{{ model.uuid }}/unlock" style="display:inline">
        <button class="btn ghost" type="submit">ğŸ”“ è§£é™¤</button>
      </form>
    {% endif %}
    {% if not model.is_certified %}
      <form method="post" action="/admin/models/{{ model.uuid }}/certify" style="display:inline"><button class="btn ghost" type="submit">âœ” èªè¨¼ä»˜ä¸</button></form>
    {% else %}
      <form method="post" action="/admin/models/{{ model.uuid }}/decertify" style="display:inline"><button class="btn ghost" type="submit">âœ– èªè¨¼è§£é™¤</button></form>
    {% endif %}
    <form method="post" action="/admin/models/{{ model.uuid }}/delete" style="display:inline" onsubmit="return confirm('é‹å–¶ã«ã‚ˆã‚‹å®Œå…¨å‰Šé™¤ã§ã™ã€‚ã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿ');"><button class="btn ghost" type="submit">ğŸ—‘ é‹å–¶å‰Šé™¤</button></form>
  {% endif %}
</p>
{% if sample_images and sample_images|length > 0 %}
  <h2>ã‚µãƒ³ãƒ—ãƒ«ç”»åƒï¼ˆè¤‡æ•°ï¼‰</h2>
  <div class="card-grid">
    {% for img in sample_images %}
      <div class="card">
        <div class="card-thumb">
          <img src="/media/models/{{ model.uuid }}/samples/{{ img.uuid }}" alt="sample image">
        </div>
        <div class="card-body"><div class="muted">#{{ img.sample_audios }}</div></div>
      </div>
    {% endfor %}
  </div>
{% endif %}

{# æ–°æ–¹å¼ï¼šè¤‡æ•°éŸ³å£° #}
{% if sample_audios and sample_audios|length > 0 %}
  <h2>ã‚µãƒ³ãƒ—ãƒ«éŸ³å£°ï¼ˆè¤‡æ•°ï¼‰</h2>
  <div class="list">
    {% for aui in range(sample_audios.__len__()) %}
      <li class="sample-box"><audio controls src="/media/models/{{ model.uuid }}/samples/{{ sample_audios[aui].uuid }}" style="width:100%"></audio><span class="muted">#{{ aui }}</span></li>
    {% endfor %}
  </div>
{% endif %}

{% if units %}
<h2>æ‰€å±ãƒ¦ãƒ‹ãƒƒãƒˆ</h2>
<div class="chip-row">
  {% for u in units %}
    <a class="chip" href="/units/{{ u.uuid }}">
      {% if u.icon_path %}
        <img src="/media/units/{{ u.uuid }}/icon" alt="">
      {% else %}
        <img src="/static/defaults/unit.svg" alt="">
      {% endif %}
      <span>{{ u.name }}</span>
    </a>
  {% endfor %}
</div>
{% endif %}

<h2>Every1KoeSpeech äº’æ›æƒ…å ±</h2>
<ul class="muted">
  <li>è©³ç´°API: <code>/hub/models/{{ model.uuid }}</code></li>
  <li>DLç›´ãƒªãƒ³ã‚¯: <code>/assets/models/{{ model.uuid }}/model.aivmx</code></li>
</ul>
{% endblock %}
